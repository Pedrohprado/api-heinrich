generator client {
    provider = "prisma-client-js"
}

datasource db {
    provider = "postgresql"
    url      = env("DATABASE_URL")
}

// enum Lateralidade {
//     direita
//     esquerda
//     ambas
// }

// enum UnidadeDeAtendimento {
//     ambulatorio
//     prontoSocorro
//     unimed
//     especialista
// }

enum ROLE {
    ADMIN
    STAFFAMBULATORY
    STAFFTST
    USER
}

model Register {
    id                       Int       @id @default(autoincrement())
    createdById              Int
    nome                     String
    cartao                   String
    setor                    String
    liderResponsavel         String
    descricao                String
    cliente                  String?
    produto                  String?
    nivelDoOcorrido          String //possivel nivel do ocorrido no front-end(conforme vai passando por validação, vai alterando o nivel)
    createdAt                DateTime  @default(now())
    updatedAt                DateTime  @updatedAt
    //dadas para alimentar no ambulatorio
    dataEntradaNoAmbulatorio DateTime?
    enfermeiroResponsavel    String?
    parteDoCorpoAtingida     String? //vai ter que receber um enum
    lateralidadeDoCorpo      String? //vai ter que receber um enum
    NaturezaDaLesao          String? //vai ter que receber um enum
    cid                      String? //codigo de atestado possívelmente
    diasDeAtestado           Int?
    diasDeAfastamentoReal    Int?
    unidadeDeAtendimento     String? //tem que receber um enum
    descricaoDoAcidente      String? //conforme a vitima
    dataValidacaoAmbulatorio DateTime?
    validadorAmbulatorioId   Int?

    //dados para alimentar no TST
    probabilidade      Int?
    gravidade          Int?
    fatorRiscoAcidente Int? //P x G
    dataValidacaoTST   DateTime?
    validadorTSTId     Int?

    //chave linkada dos estaff
    validadorAmbulatorio User? @relation("ValidadorAmbulatorio", fields: [validadorAmbulatorioId], references: [id])
    validadorTST         User? @relation("ValidadorTST", fields: [validadorTSTId], references: [id])
    User                 User  @relation(fields: [createdById], references: [id])
}

//a ideia para o projeto agora e ter um usuário para criar o registro, ou seja, o usuário vai estar logado, e assim conseguir criar um novo registro
//dessa forma vou conseguir colocar funções de deletar para cada registro, PUTs,
//conseguiremos ver quem está fazendos os registros e tudo mais
model User {
    id                   Int        @id @default(autoincrement())
    nome                 String     @unique
    cartao               String     @unique
    setor                String
    passwordHash         String
    role                 ROLE
    createdAt            DateTime   @default(now())
    updatedAt            DateTime   @updatedAt
    Register             Register[]
    registrosAmbulatorio Register[] @relation("ValidadorAmbulatorio")
    registrosTST         Register[] @relation("ValidadorTST")
}

// model Staff {
//     id                   Int        @id @default(autoincrement())
//     nome                 String     @unique
//     cartao               String     @unique
//     setor                String
//     passwordHash         String
//     registrosValidados   Int?       @default(0) // Campo para contar quantos registros esse staff validou
//     createdAt            DateTime   @default(now())
//     updatedAt            DateTime   @updatedAt
//     // Relação inversa para os registros que cada staff validou
//     registrosAmbulatorio Register[] @relation("ValidadorAmbulatorio")
//     registrosTST         Register[] @relation("ValidadorTST")
// }
