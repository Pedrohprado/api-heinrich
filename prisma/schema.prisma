generator client {
    provider = "prisma-client-js"
}

datasource db {
    provider = "postgresql"
    url      = env("DATABASE_URL")
}

// enum Lateralidade {
//     direita
//     esquerda
//     ambas
// }

// enum UnidadeDeAtendimento {
//     ambulatorio
//     prontoSocorro
//     unimed
//     especialista
// }

model Register {
    id                       Int       @id @default(autoincrement())
    nome                     String
    cartao                   String
    setor                    String
    liderResponsavel         String
    descricao                String
    cliente                  String?
    produto                  String?
    nivelDoOcorrido          String //possivel nivel do ocorrido no front-end(conforme vai passando por validação, vai alterando o nivel)
    createdAt                DateTime  @default(now())
    updatedAt                DateTime  @updatedAt
    //dadas para alimentar no ambulatorio
    dataEntradaNoAmbulatorio DateTime?
    enfermeiroResponsavel    String?
    parteDoCorpoAtingida     String? //vai ter que receber um enum
    lateralidadeDoCorpo      String? //vai ter que receber um enum
    NaturezaDaLesao          String? //vai ter que receber um enum
    cid                      String? //codigo de atestado possívelmente
    diasDeAtestado           Int?
    diasDeAfastamentoReal    Int?
    unidadeDeAtendimento     String? //tem que receber um enum
    descricaoDoAcidente      String? //conforme a vitima
    dataValidacaoAmbulatorio DateTime?
    validadorAmbulatorioId   Int?

    //dados para alimentar no TST
    probabilidade      Int?
    gravidade          Int?
    fatorRiscoAcidente Int? //P x 
    dataValidacaoTST   DateTime?
    validadorTSTId     Int?

    //chave linkada dos estaff
    validadorAmbulatorio Staff? @relation("ValidadorAmbulatorio", fields: [validadorAmbulatorioId], references: [id])
    validadorTST         Staff? @relation("ValidadorTST", fields: [validadorTSTId], references: [id])
}

model Staff {
    id                   Int        @id @default(autoincrement())
    nome                 String     @unique
    cartao               String     @unique
    setor                String
    passwordHash         String
    registrosValidados   Int?       @default(0) // Campo para contar quantos registros esse staff validou
    createdAt            DateTime   @default(now())
    updatedAt            DateTime   @updatedAt
    // Relação inversa para os registros que cada staff validou
    registrosAmbulatorio Register[] @relation("ValidadorAmbulatorio")
    registrosTST         Register[] @relation("ValidadorTST")
}
